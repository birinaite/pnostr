const loader=document.getElementById("loader");const percentText=document.getElementById("percent");const iElement=document.querySelector("[data-media]");let dataImg;try{const postId=getPostIdFromUrl();if(!postId){throw new Error("ID da mídia não fornecido")}dataImg=JSON.parse(atob(postId))}catch(error){hideLoader();const errorMessage=document.createElement("div");errorMessage.classList.add("error-message");errorMessage.textContent="ID da mídia não fornecido";document.body.appendChild(errorMessage)}function updateLoaderProgress(percentage){percentText.textContent=`${percentage}%`}function hideLoader(){loader.classList.add("hidden")}if(dataImg){loader.classList.remove("hidden");fetchControlFragments(dataImg.id,dataImg.relay).then(dataList=>{const blob=base64ToBlob(dataList);const mimeType=blob.type;if(mimeType.startsWith("image/")){const imageUrl=URL.createObjectURL(blob);const imgElement=document.createElement("img");imgElement.src=imageUrl;imgElement.alt="Imagem carregada dinamicamente";iElement.appendChild(imgElement)}else if(mimeType==="application/pdf"){const pdfUrl=URL.createObjectURL(blob);const pdfElement=document.createElement("embed");pdfElement.src=pdfUrl;pdfElement.type="application/pdf";pdfElement.style.width="100vw";pdfElement.style.height="100vh";pdfElement.style.position="fixed";pdfElement.style.top="0";pdfElement.style.left="0";pdfElement.style.zIndex="9999";iElement.appendChild(pdfElement)}else if(mimeType.startsWith("audio/")){const audioUrl=URL.createObjectURL(blob);const audioElement=document.createElement("audio");audioElement.src=audioUrl;audioElement.controls=true;audioElement.autoplay=true;audioElement.alt="Áudio carregado dinamicamente";iElement.appendChild(audioElement)}else if(mimeType.startsWith("video/")){const videoUrl=URL.createObjectURL(blob);const videoContainer=document.createElement("div");videoContainer.classList.add("video-container");const videoElement=document.createElement("video");videoElement.src=videoUrl;videoElement.controls=true;videoElement.autoplay=true;videoContainer.appendChild(videoElement);document.body.appendChild(videoContainer)}else{console.error("Tipo de arquivo não suportado:",mimeType)}hideLoader()})["catch"](error=>{console.error("Erro ao carregar fragmentos:",error);hideLoader()})}
